name: Build ZeedcomPOS

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸš€ Checkout repository
        uses: actions/checkout@v4

      - name: â˜• Setup Java
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '8'

      - name: ðŸ“¦ Install missing dependencies
        run: |
          mkdir -p lib
          cd lib
          # RXTX for serial communication
          curl -L -o RXTXcomm.jar https://repo1.maven.org/maven2/org/rxtx/rxtx/2.2pre2/rxtx-2.2pre2.jar
          # Substance Look & Feel
          curl -L -o substance.jar https://repo1.maven.org/maven2/org/pushing-pixels/substance/7.3/substance-7.3.jar
          # SwingX
          curl -L -o swingx-all.jar https://repo1.maven.org/maven2/org/swinglabs/swingx-all/1.6.5-1/swingx-all-1.6.5-1.jar
          # JasperReports
          curl -L -o jasperreports.jar https://repo1.maven.org/maven2/net/sf/jasperreports/jasperreports/6.20.6/jasperreports-6.20.6.jar
          # Barcode4J
          curl -L -o barcode4j.jar https://repo1.maven.org/maven2/org/krysalis/barcode4j/barcode4j/2.1/barcode4j-2.1.jar
          # Apache Commons Lang
          curl -L -o commons-lang.jar https://repo1.maven.org/maven2/commons-lang/commons-lang/2.6/commons-lang-2.6.jar
          # CSV Reader
          curl -L -o csvreader.jar https://repo1.maven.org/maven2/net/sourceforge/javacsv/javacsv/2.0/javacsv-2.0.jar
          # JavaPOS
          curl -L -o javapos.jar https://repo1.maven.org/maven2/org/javapos/javapos/1.14.3/javapos-1.14.3.jar
          cd ..

      - name: ðŸ§± Build project using Ant
        run: |
          echo "ðŸš€ Starting Ant build..."
          ant -noinput -buildfile build.xml clean jar

      - name: ðŸ“¦ Upload build artifact
        uses: actions/upload-artifact@v4
        with:
          name: ZeedcomPOS-Build
          path: dist/*.jar
